module Data.Cars exposing
    ( CarMake
    , CarStyle
    , carAsset
    , sedan
    , sedanGraphics
    , sedanGraphicsLazy
    , testCar
    )

import Color exposing (Color)
import Data.Colors as Colors
import Length exposing (Length)
import Model.Geometry exposing (LMShape2d)
import Point2d
import Polygon2d
import Quantity
import Svg exposing (Svg, path)
import Svg.Attributes as Attributes
import Svg.Lazy


type alias CarMake =
    { bodyColor : Color
    , detailColor : Color
    , length : Length
    , width : Length
    , shapeAtOrigin : LMShape2d
    , style : CarStyle
    }


type CarStyle
    = Sedan


carAsset : CarMake -> ( Svg msg, String )
carAsset make =
    ( sedanGraphicsLazy make.bodyColor make.detailColor, sedanViewBox )


sedan : CarMake
sedan =
    let
        length =
            Length.meters 4.6

        width =
            Length.meters 2.3

        halfLength =
            Quantity.half length

        halfWidth =
            Quantity.half width

        p1 =
            Point2d.xy
                (Quantity.negate halfLength)
                (Quantity.negate halfWidth)

        p2 =
            Point2d.xy
                halfLength
                (Quantity.negate halfWidth)

        p3 =
            Point2d.xy
                halfLength
                halfWidth

        p4 =
            Point2d.xy
                (Quantity.negate halfLength)
                halfWidth

        shape =
            Polygon2d.singleLoop [ p1, p2, p3, p4 ]
    in
    { bodyColor = Colors.darkBlue
    , detailColor = Colors.darkBlueDarker
    , length = length
    , width = width
    , shapeAtOrigin = shape
    , style = Sedan
    }


testCar : CarMake
testCar =
    { sedan
        | bodyColor = Colors.red
        , detailColor = Colors.redDarker
    }


sedanViewBox : String
sedanViewBox =
    "0 0 74 38"


sedanGraphicsLazy : Color -> Color -> Svg msg
sedanGraphicsLazy =
    Svg.Lazy.lazy2 sedanGraphics


sedanGraphics : Color -> Color -> Svg msg
sedanGraphics bodyColor detailColor =
    let
        detailColorCSS =
            Color.toCssString detailColor
    in
    Svg.g
        []
        [ path
            [ Attributes.d "M1 18.9357C1 23.889 1.7257 29.393 2.28232 32.8862C2.61993 35.0049 4.3824 36.5658 6.52554 36.6657C9.24367 36.7925 13.2669 36.9176 17.8 36.8534C22.6462 36.7847 25.6751 36.0539 30.7149 36.0539C36.9965 36.0539 47.2957 36.7621 54 36.8534C58.1442 36.9098 61.8318 36.7966 64.3985 36.6765C66.7014 36.5688 68.7231 35.1633 69.4897 32.989C70.675 29.6277 72.2 24.2669 72.2 18.9357C72.2 13.6042 70.6749 8.24321 69.4896 4.88197C68.723 2.70789 66.7016 1.30244 64.3988 1.19454C61.8322 1.07427 58.1444 0.960938 54 1.01737C47.2957 1.10866 36.9965 1.81742 30.7149 1.81742C25.6751 1.81742 22.6462 1.08601 17.8 1.01737C13.2667 0.953163 9.24335 1.07844 6.52521 1.20536C4.38222 1.30543 2.61996 2.86626 2.28237 4.98485C1.72574 8.47795 1 13.9822 1 18.9357Z"
            , Attributes.fill (Color.toCssString bodyColor)
            ]
            []
        , path
            [ Attributes.d "M67.0002 7.0001C66.6002 5.2001 66.2002 2.6001 66.2002 2.6001H67.4002L69.2002 4.6001L70.2002 10.2001C70.2002 10.2001 67.4002 8.8001 67.0002 7.0001Z"
            , Attributes.fill Colors.gray7CSS
            ]
            []
        , path
            [ Attributes.fillRule "evenodd"
            , Attributes.clipRule "evenodd"
            , Attributes.d "M65.9668 2.3999H67.489L69.3868 4.50854L70.4668 10.557L70.1105 10.3788L70.1999 10.1999C70.1105 10.3788 70.1105 10.3788 70.1105 10.3788L70.1078 10.3774L70.1011 10.3741C70.0954 10.3711 70.087 10.3668 70.0763 10.3613C70.0547 10.3501 70.0234 10.3336 69.9837 10.3122C69.9043 10.2693 69.7911 10.2063 69.6542 10.1251C69.3806 9.96284 69.0112 9.72719 68.6282 9.43362C67.8737 8.85516 67.0212 8.01772 66.8047 7.04329C66.6036 6.13841 66.4029 5.03455 66.2528 4.1587C66.1777 3.72039 66.115 3.33845 66.0712 3.06605C66.0493 2.92985 66.0321 2.821 66.0203 2.74617L66.0069 2.66025L66.0023 2.63035L65.9668 2.3999ZM66.4337 2.7999C66.443 2.85791 66.4538 2.92585 66.4661 3.0025C66.5098 3.27386 66.5722 3.65442 66.647 4.09111C66.7969 4.96525 66.9962 6.06139 67.1952 6.95652C67.3786 7.78209 68.1261 8.54464 68.8716 9.11618C69.2387 9.39761 69.5942 9.62446 69.8582 9.781C69.8828 9.79558 69.9065 9.80953 69.9294 9.82286L69.0131 4.69126L67.3108 2.7999H66.4337Z"
            , Attributes.fill detailColorCSS
            ]
            []
        , path
            [ Attributes.d "M67.0002 30.9999C66.6002 32.7999 66.2002 35.3999 66.2002 35.3999H67.4002L69.2002 33.3999L70.2002 27.7999C70.2002 27.7999 67.4002 29.1999 67.0002 30.9999Z"
            , Attributes.fill Colors.gray7CSS
            ]
            []
        , path
            [ Attributes.fillRule "evenodd"
            , Attributes.clipRule "evenodd"
            , Attributes.d "M65.9668 35.6001H67.489L69.3868 33.4915L70.4668 27.443L70.1105 27.6212L70.1999 27.8001C70.1105 27.6212 70.1105 27.6212 70.1105 27.6212L70.1078 27.6226L70.1011 27.6259C70.0954 27.6289 70.087 27.6332 70.0763 27.6387C70.0547 27.6499 70.0234 27.6664 69.9837 27.6878C69.9043 27.7307 69.7911 27.7937 69.6542 27.8749C69.3806 28.0372 69.0112 28.2728 68.6282 28.5664C67.8737 29.1448 67.0212 29.9823 66.8047 30.9567C66.6036 31.8616 66.4029 32.9654 66.2528 33.8413C66.1777 34.2796 66.115 34.6616 66.0712 34.9339C66.0493 35.0702 66.0321 35.179 66.0203 35.2538L66.0069 35.3397L66.0023 35.3696L65.9668 35.6001ZM66.4337 35.2001C66.443 35.1421 66.4538 35.0742 66.4661 34.9975C66.5098 34.7261 66.5722 34.3456 66.647 33.9089C66.7969 33.0347 66.9962 31.9386 67.1952 31.0435C67.3786 30.2179 68.1261 29.4554 68.8716 28.8838C69.2387 28.6024 69.5942 28.3755 69.8582 28.219C69.8828 28.2044 69.9065 28.1905 69.9294 28.1771L69.0131 33.3087L67.3108 35.2001H66.4337Z"
            , Attributes.fill detailColorCSS
            ]
            []
        , path
            [ Attributes.fillRule "evenodd"
            , Attributes.clipRule "evenodd"
            , Attributes.d "M17.7858 2.01727C13.2781 1.95342 9.27576 2.07801 6.57185 2.20427C4.89739 2.28246 3.53215 3.49649 3.26991 5.14221C2.7158 8.6195 2 14.0619 2 18.9357C2 23.8092 2.71576 29.2515 3.26986 32.7288C3.53212 34.3746 4.89752 35.5887 6.57213 35.6668C9.27604 35.7929 13.2783 35.9173 17.7858 35.8535C20.047 35.8215 21.9033 35.6428 23.8001 35.4603C23.8963 35.451 23.9927 35.4417 24.0893 35.4325C26.0871 35.2407 28.1443 35.0539 30.7149 35.0539C33.8825 35.0539 38.0516 35.2322 42.2438 35.4204C42.5512 35.4342 42.8588 35.4481 43.1662 35.4619C47.0634 35.6375 50.9247 35.8114 54.0136 35.8535C58.1327 35.9096 61.7994 35.7971 64.3517 35.6776C66.2772 35.5875 67.9248 34.4201 68.5467 32.6564C69.7173 29.3366 71.2 24.1005 71.2 18.9357C71.2 13.7706 69.7172 8.53434 68.5465 5.21452C67.9247 3.45097 66.2774 2.28366 64.352 2.19344C61.7998 2.07385 58.1329 1.96119 54.0136 2.01728C50.9244 2.05934 47.0626 2.23343 43.1651 2.40914C42.8581 2.42298 42.5509 2.43683 42.2438 2.45062C38.0517 2.63896 33.8826 2.81742 30.7149 2.81742C28.1442 2.81742 26.087 2.63045 24.0892 2.43855C23.9928 2.42929 23.8965 2.42002 23.8003 2.41075C21.9034 2.22807 20.047 2.0493 17.7858 2.01727ZM6.47856 0.206449C9.21093 0.0788596 13.2554 -0.047098 17.8142 0.0174708C20.1592 0.0506853 22.0882 0.236535 23.9779 0.418599C24.0789 0.428324 24.1797 0.438038 24.2804 0.447717C26.2686 0.638689 28.2458 0.817422 30.7149 0.817422C33.8288 0.817422 37.9501 0.641503 42.1541 0.452637C42.4639 0.438718 42.7742 0.424729 43.0845 0.410738C46.971 0.235505 50.8639 0.0599804 53.9864 0.0174633C58.1559 -0.0393119 61.8645 0.0746909 64.4457 0.195635C67.1259 0.321223 69.5213 1.96481 70.4327 4.54942C71.6326 7.95208 73.2 13.4378 73.2 18.9357C73.2 24.4333 71.6327 29.9188 70.4328 33.3215C69.5214 35.9064 67.1256 37.55 64.4452 37.6754C61.8641 37.7962 58.1557 37.9101 53.9864 37.8533C50.8642 37.8108 46.9717 37.6354 43.0855 37.4603C42.7749 37.4463 42.4643 37.4323 42.1541 37.4184C37.9502 37.2297 33.8289 37.0539 30.7149 37.0539C28.2457 37.0539 26.2686 37.2325 24.2804 37.4233C24.1796 37.433 24.0787 37.4427 23.9778 37.4524C22.0881 37.6344 20.1591 37.8201 17.8142 37.8533C13.2556 37.9178 9.21131 37.7921 6.47895 37.6646C3.86728 37.5428 1.70775 35.6352 1.29478 33.0435C0.735641 29.5346 0 23.9688 0 18.9357C0 13.9024 0.735684 8.33639 1.29483 4.82748C1.70777 2.23603 3.86705 0.328395 6.47856 0.206449Z"
            , Attributes.fill Colors.gray1CSS
            ]
            []
        , path
            [ Attributes.d "M36.9158 31.6188L44.0797 32.4111C45.1286 32.5271 46.0848 31.8112 46.247 30.7684C46.673 28.0289 47.3998 22.8273 47.3998 19.2175C47.3998 15.6107 46.6743 10.2156 46.2481 7.3569C46.0871 6.27742 45.0798 5.54731 44.0004 5.70924L36.8678 6.77932C36.2606 6.87042 35.8197 7.40154 35.8442 8.01503C35.9337 10.2567 36.127 15.5267 36.127 19.2175C36.127 22.885 35.9361 28.1119 35.8459 30.3772C35.8208 31.0085 36.2878 31.5494 36.9158 31.6188Z"
            , Attributes.fill Colors.gray7CSS
            ]
            []
        , path
            [ Attributes.fillRule "evenodd"
            , Attributes.clipRule "evenodd"
            , Attributes.d "M43.9919 33.2063L36.8281 32.4139C35.7842 32.2985 35.0049 31.3979 35.0468 30.3453C35.137 28.079 35.3272 22.8669 35.3272 19.2174C35.3272 15.5447 35.1346 10.2896 35.0451 8.0469C35.0042 7.02402 35.7401 6.13955 36.7493 5.98814L43.882 4.91805C45.3895 4.69188 46.812 5.71316 47.0395 7.23888C47.4649 10.0919 48.2 15.543 48.2 19.2174C48.2 22.8972 47.4631 28.1558 47.0377 30.8914C46.8082 32.3664 45.4569 33.3683 43.9919 33.2063ZM44.0799 32.4111L36.916 31.6188C36.288 31.5493 35.821 31.0085 35.8461 30.3771C35.9364 28.1118 36.1272 22.8849 36.1272 19.2174C36.1272 15.5267 35.9339 10.2567 35.8444 8.01499C35.82 7.4015 36.2608 6.87038 36.868 6.77928L44.0007 5.7092C45.08 5.54727 46.0873 6.27738 46.2483 7.35686C46.6745 10.2155 47.4 15.6107 47.4 19.2174C47.4 22.8273 46.6733 28.0288 46.2472 30.7684C46.085 31.8112 45.1288 32.5271 44.0799 32.4111Z"
            , Attributes.fill detailColorCSS
            ]
            []
        , path
            [ Attributes.d "M23.772 30.0783L17.8473 30.1879C16.9149 30.2051 16.0963 29.5782 15.8977 28.6671C15.4116 26.437 14.6 22.2551 14.6 19.1888C14.6 16.1278 15.4087 11.7875 15.8951 9.45368C16.0932 8.50355 16.9603 7.8581 17.9293 7.91401L23.8209 8.25396C24.4751 8.29171 24.9785 8.84516 24.9537 9.50002C24.8737 11.6174 24.7179 16.1303 24.7179 19.1888C24.7179 22.2251 24.8714 26.695 24.952 28.8312C24.9773 29.5044 24.4455 30.0658 23.772 30.0783Z"
            , Attributes.fill Colors.gray7CSS
            ]
            []
        , path
            [ Attributes.fillRule "evenodd"
            , Attributes.clipRule "evenodd"
            , Attributes.d "M17.8619 30.9877L23.7866 30.8781C24.9069 30.8574 25.7935 29.9227 25.7512 28.801C25.6706 26.6635 25.5177 22.2079 25.5177 19.1887C25.5177 16.1475 25.6728 11.6489 25.7529 9.53018C25.7942 8.43969 24.9556 7.51805 23.8668 7.45523L17.9752 7.11528C16.6223 7.03723 15.393 7.94086 15.1118 9.2904C14.6263 11.6194 13.7998 16.0348 13.7998 19.1887C13.7998 22.3511 14.6302 26.6097 15.1158 28.8374C15.3984 30.1335 16.5603 31.0118 17.8619 30.9877ZM17.8471 30.1878L23.7718 30.0782C24.4453 30.0658 24.9771 29.5044 24.9518 28.8312C24.8712 26.6949 24.7177 22.225 24.7177 19.1887C24.7177 16.1303 24.8735 11.6174 24.9535 9.49996C24.9783 8.84511 24.4749 8.29165 23.8207 8.2539L17.9291 7.91396C16.9601 7.85805 16.093 8.50349 15.8949 9.45363C15.4085 11.7874 14.5998 16.1277 14.5998 19.1887C14.5998 22.2551 15.4113 26.437 15.8975 28.667C16.0961 29.5781 16.9147 30.2051 17.8471 30.1878Z"
            , Attributes.fill detailColorCSS
            ]
            []
        ]
